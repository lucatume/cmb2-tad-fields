define(["../core","../var/support","../ajax"],function(e,c){e.ajaxSettings.xhr=function(){try{return new XMLHttpRequest()}catch(g){}};var d=0,b={},a={0:200,1223:204},f=e.ajaxSettings.xhr();if(window.attachEvent){window.attachEvent("onunload",function(){for(var g in b){b[g]()}})}c.cors=!!f&&("withCredentials" in f);c.ajax=f=!!f;e.ajaxTransport(function(g){var h;if(c.cors||f&&!g.crossDomain){return{send:function(n,j){var k,m=g.xhr(),o=++d;m.open(g.type,g.url,g.async,g.username,g.password);if(g.xhrFields){for(k in g.xhrFields){m[k]=g.xhrFields[k]}}if(g.mimeType&&m.overrideMimeType){m.overrideMimeType(g.mimeType)}if(!g.crossDomain&&!n["X-Requested-With"]){n["X-Requested-With"]="XMLHttpRequest"}for(k in n){m.setRequestHeader(k,n[k])}h=function(i){return function(){if(h){delete b[o];h=m.onload=m.onerror=null;if(i==="abort"){m.abort()}else{if(i==="error"){j(m.status,m.statusText)}else{j(a[m.status]||m.status,m.statusText,typeof m.responseText==="string"?{text:m.responseText}:undefined,m.getAllResponseHeaders())}}}}};m.onload=h();m.onerror=h("error");h=b[o]=h("abort");try{m.send(g.hasContent&&g.data||null)}catch(l){if(h){throw l}}},abort:function(){if(h){h()}}}}})});