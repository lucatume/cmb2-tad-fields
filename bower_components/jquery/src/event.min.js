define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./data/var/data_priv","./core/init","./data/accepts","./selector"],function(n,f,k,g,i,j,a){var m=/^key/,d=/^(?:mouse|pointer|contextmenu)|click/,h=/^(?:focusinfocus|focusoutblur)$/,c=/^([^.]*)(?:\.(.+)|)$/;function e(){return true}function b(){return false}function l(){try{return document.activeElement}catch(o){}}n.event={global:{},add:function(s,y,F,v,u){var q,x,w,E,D,C,A,r,B,o,p,z=a.get(s);if(!z){return}if(F.handler){q=F;F=q.handler;u=q.selector}if(!F.guid){F.guid=n.guid++}if(!(E=z.events)){E=z.events={}}if(!(x=z.handle)){x=z.handle=function(t){return typeof n!==f&&n.event.triggered!==t.type?n.event.dispatch.apply(s,arguments):undefined}}y=(y||"").match(k)||[""];D=y.length;while(D--){w=c.exec(y[D])||[];B=p=w[1];o=(w[2]||"").split(".").sort();if(!B){continue}A=n.event.special[B]||{};B=(u?A.delegateType:A.bindType)||B;A=n.event.special[B]||{};C=n.extend({type:B,origType:p,data:v,handler:F,guid:F.guid,selector:u,needsContext:u&&n.expr.match.needsContext.test(u),namespace:o.join(".")},q);if(!(r=E[B])){r=E[B]=[];r.delegateCount=0;if(!A.setup||A.setup.call(s,v,o,x)===false){if(s.addEventListener){s.addEventListener(B,x,false)}}}if(A.add){A.add.call(s,C);if(!C.handler.guid){C.handler.guid=F.guid}}if(u){r.splice(r.delegateCount++,0,C)}else{r.push(C)}n.event.global[B]=true}},remove:function(r,y,F,s,x){var v,u,w,E,D,C,A,q,B,o,p,z=a.hasData(r)&&a.get(r);if(!z||!(E=z.events)){return}y=(y||"").match(k)||[""];D=y.length;while(D--){w=c.exec(y[D])||[];B=p=w[1];o=(w[2]||"").split(".").sort();if(!B){for(B in E){n.event.remove(r,B+y[D],F,s,true)}continue}A=n.event.special[B]||{};B=(s?A.delegateType:A.bindType)||B;q=E[B]||[];w=w[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)");u=v=q.length;while(v--){C=q[v];if((x||p===C.origType)&&(!F||F.guid===C.guid)&&(!w||w.test(C.namespace))&&(!s||s===C.selector||s==="**"&&C.selector)){q.splice(v,1);if(C.selector){q.delegateCount--}if(A.remove){A.remove.call(r,C)}}}if(u&&!q.length){if(!A.teardown||A.teardown.call(r,o,z.handle)===false){n.removeEvent(r,B,z.handle)}delete E[B]}}if(n.isEmptyObject(E)){delete z.handle;a.remove(r,"events")}},trigger:function(o,t,r,B){var u,z,v,A,q,w,x,s=[r||document],y=g.call(o,"type")?o.type:o,p=g.call(o,"namespace")?o.namespace.split("."):[];z=v=r=r||document;if(r.nodeType===3||r.nodeType===8){return}if(h.test(y+n.event.triggered)){return}if(y.indexOf(".")>=0){p=y.split(".");y=p.shift();p.sort()}q=y.indexOf(":")<0&&"on"+y;o=o[n.expando]?o:new n.Event(y,typeof o==="object"&&o);o.isTrigger=B?2:3;o.namespace=p.join(".");o.namespace_re=o.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;o.result=undefined;if(!o.target){o.target=r}t=t==null?[o]:n.makeArray(t,[o]);x=n.event.special[y]||{};if(!B&&x.trigger&&x.trigger.apply(r,t)===false){return}if(!B&&!x.noBubble&&!n.isWindow(r)){A=x.delegateType||y;if(!h.test(A+y)){z=z.parentNode}for(;z;z=z.parentNode){s.push(z);v=z}if(v===(r.ownerDocument||document)){s.push(v.defaultView||v.parentWindow||window)}}u=0;while((z=s[u++])&&!o.isPropagationStopped()){o.type=u>1?A:x.bindType||y;w=(a.get(z,"events")||{})[o.type]&&a.get(z,"handle");if(w){w.apply(z,t)}w=q&&z[q];if(w&&w.apply&&n.acceptData(z)){o.result=w.apply(z,t);if(o.result===false){o.preventDefault()}}}o.type=y;if(!B&&!o.isDefaultPrevented()){if((!x._default||x._default.apply(s.pop(),t)===false)&&n.acceptData(r)){if(q&&n.isFunction(r[y])&&!n.isWindow(r)){v=r[q];if(v){r[q]=null}n.event.triggered=y;r[y]();n.event.triggered=undefined;if(v){r[q]=v}}}}return o.result},dispatch:function(o){o=n.event.fix(o);var s,r,t,p,x,w=[],v=i.call(arguments),q=(a.get(this,"events")||{})[o.type]||[],u=n.event.special[o.type]||{};v[0]=o;o.delegateTarget=this;if(u.preDispatch&&u.preDispatch.call(this,o)===false){return}w=n.event.handlers.call(this,o,q);s=0;while((p=w[s++])&&!o.isPropagationStopped()){o.currentTarget=p.elem;r=0;while((x=p.handlers[r++])&&!o.isImmediatePropagationStopped()){if(!o.namespace_re||o.namespace_re.test(x.namespace)){o.handleObj=x;o.data=x.data;t=((n.event.special[x.origType]||{}).handle||x.handler).apply(p.elem,v);if(t!==undefined){if((o.result=t)===false){o.preventDefault();o.stopPropagation()}}}}}if(u.postDispatch){u.postDispatch.call(this,o)}return o.result},handlers:function(o,q){var s,t,p,v,u=[],r=q.delegateCount,w=o.target;if(r&&w.nodeType&&(!o.button||o.type!=="click")){for(;w!==this;w=w.parentNode||this){if(w.disabled!==true||o.type!=="click"){t=[];for(s=0;s<r;s++){v=q[s];p=v.selector+" ";if(t[p]===undefined){t[p]=v.needsContext?n(p,this).index(w)>=0:n.find(p,this,null,[w]).length}if(t[p]){t.push(v)}}if(t.length){u.push({elem:w,handlers:t})}}}}if(r<q.length){u.push({elem:this,handlers:q.slice(r)})}return u},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(p,o){if(p.which==null){p.which=o.charCode!=null?o.charCode:o.keyCode}return p}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(r,q){var s,t,o,p=q.button;if(r.pageX==null&&q.clientX!=null){s=r.target.ownerDocument||document;t=s.documentElement;o=s.body;r.pageX=q.clientX+(t&&t.scrollLeft||o&&o.scrollLeft||0)-(t&&t.clientLeft||o&&o.clientLeft||0);r.pageY=q.clientY+(t&&t.scrollTop||o&&o.scrollTop||0)-(t&&t.clientTop||o&&o.clientTop||0)}if(!r.which&&p!==undefined){r.which=(p&1?1:(p&2?3:(p&4?2:0)))}return r}},fix:function(r){if(r[n.expando]){return r}var p,u,t,q=r.type,o=r,s=this.fixHooks[q];if(!s){this.fixHooks[q]=s=d.test(q)?this.mouseHooks:m.test(q)?this.keyHooks:{}}t=s.props?this.props.concat(s.props):this.props;r=new n.Event(o);p=t.length;while(p--){u=t[p];r[u]=o[u]}if(!r.target){r.target=document}if(r.target.nodeType===3){r.target=r.target.parentNode}return s.filter?s.filter(r,o):r},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==l()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===l()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&n.nodeName(this,"input")){this.click();return false}},_default:function(o){return n.nodeName(o.target,"a")}},beforeunload:{postDispatch:function(o){if(o.result!==undefined&&o.originalEvent){o.originalEvent.returnValue=o.result}}}},simulate:function(p,r,q,o){var s=n.extend(new n.Event(),q,{type:p,isSimulated:true,originalEvent:{}});if(o){n.event.trigger(s,null,r)}else{n.event.dispatch.call(r,s)}if(s.isDefaultPrevented()){q.preventDefault()}}};n.removeEvent=function(p,o,q){if(p.removeEventListener){p.removeEventListener(o,q,false)}};n.Event=function(p,o){if(!(this instanceof n.Event)){return new n.Event(p,o)}if(p&&p.type){this.originalEvent=p;this.type=p.type;this.isDefaultPrevented=p.defaultPrevented||p.defaultPrevented===undefined&&p.returnValue===false?e:b}else{this.type=p}if(o){n.extend(this,o)}this.timeStamp=p&&p.timeStamp||n.now();this[n.expando]=true};n.Event.prototype={isDefaultPrevented:b,isPropagationStopped:b,isImmediatePropagationStopped:b,preventDefault:function(){var o=this.originalEvent;this.isDefaultPrevented=e;if(o&&o.preventDefault){o.preventDefault()}},stopPropagation:function(){var o=this.originalEvent;this.isPropagationStopped=e;if(o&&o.stopPropagation){o.stopPropagation()}},stopImmediatePropagation:function(){var o=this.originalEvent;this.isImmediatePropagationStopped=e;if(o&&o.stopImmediatePropagation){o.stopImmediatePropagation()}this.stopPropagation()}};n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(p,o){n.event.special[p]={delegateType:o,bindType:o,handle:function(s){var q,u=this,t=s.relatedTarget,r=s.handleObj;if(!t||(t!==u&&!n.contains(u,t))){s.type=r.origType;q=r.handler.apply(this,arguments);s.type=o}return q}}});if(!j.focusinBubbles){n.each({focus:"focusin",blur:"focusout"},function(q,o){var p=function(r){n.event.simulate(o,r.target,n.event.fix(r),true)};n.event.special[o]={setup:function(){var s=this.ownerDocument||this,r=a.access(s,o);if(!r){s.addEventListener(q,p,true)}a.access(s,o,(r||0)+1)},teardown:function(){var s=this.ownerDocument||this,r=a.access(s,o)-1;if(!r){s.removeEventListener(q,p,true);a.remove(s,o)}else{a.access(s,o,r)}}}})}n.fn.extend({on:function(q,o,t,s,p){var u,r;if(typeof q==="object"){if(typeof o!=="string"){t=t||o;o=undefined}for(r in q){this.on(r,o,t,q[r],p)}return this}if(t==null&&s==null){s=o;t=o=undefined}else{if(s==null){if(typeof o==="string"){s=t;t=undefined}else{s=t;t=o;o=undefined}}}if(s===false){s=b}else{if(!s){return this}}if(p===1){u=s;s=function(v){n().off(v);return u.apply(this,arguments)};s.guid=u.guid||(u.guid=n.guid++)}return this.each(function(){n.event.add(this,q,s,t,o)})},one:function(p,o,r,q){return this.on(p,o,r,q,1)},off:function(q,o,s){var p,r;if(q&&q.preventDefault&&q.handleObj){p=q.handleObj;n(q.delegateTarget).off(p.namespace?p.origType+"."+p.namespace:p.origType,p.selector,p.handler);return this}if(typeof q==="object"){for(r in q){this.off(r,o,q[r])}return this}if(o===false||typeof o==="function"){s=o;o=undefined}if(s===false){s=b}return this.each(function(){n.event.remove(this,q,s,o)})},trigger:function(o,p){return this.each(function(){n.event.trigger(o,p,this)})},triggerHandler:function(o,q){var p=this[0];if(p){return n.event.trigger(o,q,p,true)}}});return n});